var YEK_SED="srentrap";var baseUrl=/pretest_gpas/.test(window.location.href)?"/pretest_gpas":"/gpas";var encryptByDES={ECB:function(e,t){var n=CryptoJS.enc.Utf8.parse(t);var r=CryptoJS.DES.encrypt(e,n,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7});return r.ciphertext.toString().toLowerCase()},CBC:function(e,t){var n=CryptoJS.enc.Utf8.parse(t);var r=CryptoJS.DES.encrypt(e,n,{iv:n,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});return r.ciphertext.toString().toLowerCase()}};var decryptByDES={ECB:function(e,t){var n=CryptoJS.enc.Utf8.parse(t);var r=CryptoJS.DES.decrypt({ciphertext:CryptoJS.enc.Hex.parse(e.toLowerCase())},n,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7});return r.toString(CryptoJS.enc.Utf8)},CBC:function(e,t){var n=CryptoJS.enc.Utf8.parse(t);var r=CryptoJS.DES.decrypt({ciphertext:CryptoJS.enc.Hex.parse(e.toLowerCase())},n,{mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7,iv:n});return r.toString(CryptoJS.enc.Utf8)}};function encryptByMd5(e){return CryptoJS.MD5(e).toString()}function isWechat(){return/micromessenger/i.test(window.navigator.userAgent+window.navigator.platform)}function isIOS(){return/iphone|ipad|ipod/i.test(window.navigator.userAgent+window.navigator.platform)}function isAndroid(){return/android|linux/i.test(window.navigator.userAgent+window.navigator.platform)}function isWeibo(){return/weibo/i.test(window.navigator.userAgent+window.navigator.platform)}function isQQ(){return/qq/i.test(window.navigator.userAgent+window.navigator.platform)}function isZT(){return/scmcc.mobile/i.test(window.navigator.userAgent+window.navigator.platform)}function getParamValue(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i");var n=window.location.search.substr(1).match(t);if(n!=null)return n[2];return null}function getRequestParams(e,t,n,r,i){var o={};o.requrl=e;o.params=t;o.sucCb=n;o.failCb=r;o.originParams=i;return o}function sendGetRequest(t){$.ajax({type:"GET",url:t.requrl,dataType:"json",headers:{token:getSession("partnerticket"),sourceType:"public"},success:function(e){t.sucCb&&t.sucCb(e,t.originParams)},error:function(e){t.failCb&&t.failCb(e,t.originParams)}})}function saveStorage(e,t){var n=encryptByDES.CBC(JSON.stringify(t),"dzgstorage");window.localStorage.setItem(e,n)}function getStorage(e){var t=window.localStorage.getItem(e);if(t){t=decryptByDES.CBC(t,"dzgstorage");return t.replace(/^"|"$/g,"").replace(/\\/g,"")||""}return""}function removeStorage(e){window.localStorage.removeItem(e)}function saveSession(e,t){var n=encryptByDES.CBC(JSON.stringify(t),"dzgsession");window.sessionStorage.setItem(e,n)}function getSession(e,t){var n=window.sessionStorage.getItem(e);if(n){n=decryptByDES.CBC(n,"dzgsession");var r=n.replace(/^"|"$/g,"").replace(/\\/g,"")||"";if(t){try{r=JSON.parse(r)}catch(e){return r}}return r}return""}function removeSession(e){window.sessionStorage.removeItem(e)}function getJsApiConfig(e){if(!isWechat())return;var t=getStorage("ptapishare");if(t){wxConfig(e);return}var n=baseUrl+"/register/wx/jsapi/config?url="+encodeURI(window.location.href.split("#/")[0]);var r=getRequestParams(n,"",getConfigSuc,getConfigFail,e);sendGetRequest(r)}function getConfigSuc(e,t){if(e.status===0){var n=e.data;saveStorage("ptapishare",n);wxConfig(t)}else{console.info(e.msg)}}function getConfigFail(e){}function wxConfig(e){var t=getStorage("ptapishare");if(t){var n=JSON.parse(decryptByDES.CBC(t,YEK_SED));var r={appId:n.appId,timestamp:n.timestamp,nonceStr:n.nonceStr,signature:n.signature,debug:false,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","updateAppMessageShareData","updateTimelineShareData","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone","hideMenuItems","showMenuItems"]};wx.config(r);wx.ready(function(){hideMenuItems(e)});wx.error(function(){if(/palmte.cn/i.test(window.location.href)){saveStorage("ptapishare","");getJsApiConfig(e)}})}else{if(/palmte.cn/i.test(window.location.href)){saveStorage("ptapishare","");getJsApiConfig(e)}}}function showMenuItems(e){var t=["menuItem:share:qq","menuItem:share:weiboApp","menuItem:share:appMessage","menuItem:share:timeline","menuItem:favorite","menuItem:share:QZone"];if(e&&e.length>0){t=e}wx.showMenuItems({menuList:t})}function hideMenuItems(i){var e=["menuItem:share:qq","menuItem:share:weiboApp","menuItem:share:facebook","menuItem:share:QZone","menuItem:copyUrl","menuItem:openWithSafari","menuItem:openWithQQBrowser","menuItem:share:email"];if(i&&i.hideList&&i.hideList.length>0){e=i.hideList}wx.hideMenuItems({menuList:e,success:function(e){var t={title:"四川移动合伙人",desc:"猛戳进入立即注册/登录，请搜索关注“四川移动合伙人”公众号了解更多",link:window.location.origin+"/gpas/register/wx/oAuth/userInfo",imgUrl:window.location.origin+"/gpas/partner/static/img/cmcc_logo.png",success:function(){},cancel:function(){}};if(i){t=i;if(i.excuteFn)i.excuteFn();showMenuItems(i.showList)}var n={title:t.title,desc:t.desc,link:t.outerWechatLink||t.link,imgUrl:t.imgUrl,success:function(){t.success()},cancel:function(){t.cancel()}};wx.updateAppMessageShareData(n);var r={title:t.timelineTitle||t.title,link:t.outerWechatLink||t.link,imgUrl:t.imgUrl,success:function(){t.success()},cancel:function(){t.cancel()}};wx.updateTimelineShareData(r)},fail:function(e){hideMenuItems(i)}})}